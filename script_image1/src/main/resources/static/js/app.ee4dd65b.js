(function(){"use strict";var e={4930:function(e,a,t){var l=t(3751),s=t(641),n=t(953),i=t(4335),c=(t(4114),t(33));const r={class:"product-list-container"},o={class:"list-header"},u={class:"search-bar"},d={class:"button-group"},v={class:"category-tabs"},p=["onClick"],k={class:"product-grid"},g={class:"card-header"},f={class:"product-code"},h=["onClick"],y={class:"image-wrapper"},b=["src"],m={class:"product-info"},C={class:"category-tag"},L={class:"name"},w={class:"price-row"},_={class:"price"},E={key:0},X={key:1},K={key:0,class:"no-data"},O=35;var R={__name:"ProductList",props:["initialCategory"],emits:["view-detail","update-category"],setup(e,{emit:a}){const t=e,R=a,j=(0,n.KR)([]),I=(0,n.KR)(""),S=(0,n.KR)(t.initialCategory||"데스크탑"),A=(0,n.KR)(!1),Q=(0,n.KR)(0),F=(0,n.KR)(!1),x=(0,n.KR)(!1),D=(0,n.KR)(null);let W=null;const B=[{id:"데스크탑",name:"데스크탑"},{id:"소파",name:"소파"},{id:"패딩",name:"패딩"},{id:"신발",name:"신발"}],N=()=>{j.value=[],Q.value=0,x.value=!1,U()},P=e=>{S.value=e,R("update-category",e),N()},T=()=>{A.value=!A.value,N()},U=async()=>{if(F.value||x.value)return;F.value=!0;const e=A.value?"http://localhost:8083/api/new/product":"http://localhost:8083/api/product";try{const a=await i.A.get(e,{params:{page:Q.value,size:O,category:S.value,query:I.value}}),t=a.data;t.length<O&&(x.value=!0),j.value.push(...t),Q.value++}catch(a){console.error("Fetch error:",a)}finally{F.value=!1}};return(0,s.wB)(I,()=>{N()}),(0,s.sV)(()=>{U(),W=new IntersectionObserver(e=>{!e[0].isIntersecting||F.value||x.value||U()},{threshold:.1}),D.value&&W.observe(D.value)}),(0,s.hi)(()=>{W&&W.disconnect()}),(e,a)=>((0,s.uX)(),(0,s.CE)("div",r,[(0,s.Lk)("header",o,[(0,s.Lk)("div",u,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":a[0]||(a[0]=e=>I.value=e),onKeyup:(0,l.jR)(N,["enter"]),placeholder:"상품명을 입력하세요"},null,544),[[l.Jo,I.value]])]),(0,s.Lk)("div",d,[(0,s.Lk)("button",{class:(0,c.C4)(["action-btn db-toggle",A.value?"new-db-btn":"old-db-btn"]),onClick:T},(0,c.v_)(A.value?"신규 DB 데이터":"기존 DB 데이터"),3)])]),(0,s.Lk)("nav",v,[((0,s.uX)(),(0,s.CE)(s.FK,null,(0,s.pI)(B,e=>(0,s.Lk)("button",{key:e.id,class:(0,c.C4)(["tab-btn",{active:S.value===e.id}]),onClick:a=>P(e.id)},(0,c.v_)(e.name),11,p)),64))]),(0,s.Lk)("section",k,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(j.value,t=>((0,s.uX)(),(0,s.CE)("div",{key:t.id,class:"product-card"},[(0,s.Lk)("div",g,[(0,s.Lk)("span",f,(0,c.v_)(t.productCode),1)]),(0,s.Lk)("div",{class:"clickable-area",onClick:a=>e.$emit("view-detail",t.productCode,A.value)},[(0,s.Lk)("div",y,[(0,s.Lk)("img",{src:t.imageUrl,onError:a[1]||(a[1]=e=>e.target.src="/placeholder.png"),alt:"상품 이미지"},null,40,b)]),(0,s.Lk)("div",m,[(0,s.Lk)("div",C,(0,c.v_)(t.category),1),(0,s.Lk)("h3",L,(0,c.v_)(t.name),1),(0,s.Lk)("div",w,[(0,s.Lk)("span",_,(0,c.v_)(t.price?.toLocaleString())+"원",1)])])],8,h)]))),128)),(0,s.Lk)("div",{ref_key:"loadMoreTrigger",ref:D,class:"loading-trigger"},[F.value?((0,s.uX)(),(0,s.CE)("span",E,"데이터를 불러오는 중입니다...")):x.value&&j.value.length>0?((0,s.uX)(),(0,s.CE)("span",X,"모든 상품을 불러왔습니다.")):(0,s.Q3)("",!0)],512),0!==j.value.length||F.value?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",K," 조회된 상품이 없습니다. "))])]))}},j=t(6262);const I=(0,j.A)(R,[["__scopeId","data-v-6d270cae"]]);var S=I,A=(t(8111),t(1148),t(2489),t(1701),t(8335),t(4736));t(7588),t(7642),t(8004),t(3853),t(5876),t(2475),t(5024),t(1698);const Q={key:0,class:"spec-filter"},F=["onClick"],x={class:"toggle-arrow"},D={class:"filter-options"},W=["value","onChange"];var B={__name:"SpecFilter",props:{specs:{type:Object,default:()=>({})}},emits:["filter-change"],setup(e,{emit:a}){const t=a,i=(0,n.KR)({}),r=(0,n.KR)({}),o=e=>{r.value[e]=!r.value[e]},u=(e,a,l)=>{i.value[e]||(i.value[e]=new Set),l?i.value[e].add(a):(i.value[e].delete(a),0===i.value[e].size&&delete i.value[e]);const s={};Object.keys(i.value).forEach(e=>{s[e]=Array.from(i.value[e])}),t("filter-change",s)};return(a,t)=>e.specs&&Object.keys(e.specs).length>0?((0,s.uX)(),(0,s.CE)("div",Q,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.specs,(e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:"filter-group",key:a},[(0,s.Lk)("div",{class:"filter-title",onClick:e=>o(a)},[(0,s.Lk)("span",x,(0,c.v_)(r.value[a]?"▼":"▶"),1),(0,s.eW)(" "+(0,c.v_)(a),1)],8,F),(0,s.bo)((0,s.Lk)("div",D,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,e=>((0,s.uX)(),(0,s.CE)("label",{key:e,class:"filter-label"},[(0,s.Lk)("input",{type:"checkbox",value:e,onChange:t=>u(a,e,t.target.checked)},null,40,W),(0,s.eW)(" "+(0,c.v_)(e),1)]))),128))],512),[[l.aG,r.value[a]]])]))),128))])):(0,s.Q3)("",!0)}};const N=(0,j.A)(B,[["__scopeId","data-v-7f2ec7f5"]]);var P=N;const T={class:"detail-wrapper"},U={class:"detail-header"},H={key:0,class:"content-container"},V={class:"left-panel"},$={class:"image-box"},z=["src"],J={class:"product-name-left"},M={class:"product-code-left"},G={class:"right-panel"},Y={class:"tab-menu"},q={class:"tab-content"},Z={key:0,class:"fade-in"},ee={key:0,class:"spec-section"},ae={class:"spec-grid"},te={class:"spec-key"},le={class:"spec-val"},se={key:1,class:"chart-section"},ne={key:1,class:"fade-in"},ie={class:"search-widget-card"},ce={key:1,class:"filter-status"},re=["disabled"],oe={key:0,class:"result-area"},ue={class:"result-title"},de={class:"result-grid"},ve=["onClick"],pe={class:"res-img-wrapper"},ke=["src"],ge={class:"res-badge"},fe={class:"result-info"},he={class:"result-name"};var ye={__name:"ProductDetail",props:["data","isNewDb"],emits:["go-back","view-detail"],setup(e,{emit:a}){const t=e,l=a,r=(0,n.KR)([]),o=(0,n.KR)([]),u=(0,n.KR)([]),d=(0,n.KR)(!1);let v=null;const p=(0,n.KR)("info"),k=(0,s.EW)(()=>{if(!t.data?.specifications)return{};try{return"string"===typeof t.data.specifications?JSON.parse(t.data.specifications):t.data.specifications}catch(e){return{}}}),g=e=>{u.value=[],window.scrollTo({top:0,behavior:"smooth"}),l("view-detail",e,t.isNewDb)},f=e=>{e&&0!==Object.keys(e).length?(o.value=r.value.filter(a=>{if(!a.specifications)return!1;let t;try{t="string"===typeof a.specifications?JSON.parse(a.specifications):a.specifications}catch(l){return!1}return Object.keys(e).every(a=>{const l=e[a],s=t[a];return void 0!==s&&null!==s&&l.includes(String(s).trim())})}),console.log("필터 후 상품 수:",o.value.length)):o.value=r.value},h=async()=>{if(t.data)if(0!==o.value.length){d.value=!0,u.value=[];try{const e=o.value.map(e=>String(e.productCode));console.log("서버로 보내는 필터링된 상품 개수:",e.length);const a=await i.A.post("http://localhost:8083/api/similar-images",{pcode:String(t.data.productCode),top:10,filters:e});a.data.success?u.value=a.data.similarImages:alert("검색 실패: "+a.data.error)}catch(e){console.error(e),alert("유사 이미지 검색 중 오류가 발생했습니다.")}finally{d.value=!1}}else alert("선택한 조건에 맞는 상품이 없습니다. 필터를 조정해주세요.")},y=async()=>{if(!t.data?.priceHistory?.length)return;await(0,s.dY)();const e=document.getElementById("priceChart");if(!e)return;v&&v.destroy();const a=e.getContext("2d"),l=[...t.data.priceHistory].sort((e,a)=>new Date(e.date)-new Date(a.date));v=new A.Ay(a,{type:"line",data:{labels:l.map(e=>e.date),datasets:[{label:"최저가 추이 (원)",data:l.map(e=>e.price),borderColor:"#42b983",backgroundColor:"rgba(66, 185, 131, 0.1)",fill:!0,tension:.3}]},options:{responsive:!0,maintainAspectRatio:!1}})},b=(0,n.KR)({});(0,s.sV)(async()=>{y();const e=m(t.data.categoryId);try{const a=await i.A.get("http://localhost:8083/api/category/specs",{params:{category:e}});b.value=a.data.specs;const l=t.isNewDb?"http://localhost:8083/api/new/product":"http://localhost:8083/api/product",s=await i.A.get(l,{params:{size:1e3}});r.value=s.data,o.value=s.data}catch(a){console.error("데이터 로드 실패",a)}});const m=e=>112756===e?"데스크탑":15236036===e?"소파":18234911===e?"패딩":18242355===e?"신발":"기타";return(0,s.wB)(()=>t.data,()=>{y()}),(0,s.wB)(p,async e=>{"info"===e&&(await(0,s.dY)(),y())}),(a,t)=>((0,s.uX)(),(0,s.CE)("div",T,[(0,s.Lk)("header",U,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=e=>a.$emit("go-back")),class:"back-btn"},"← 목록으로 돌아가기")]),e.data?((0,s.uX)(),(0,s.CE)("div",H,[(0,s.Lk)("div",V,[(0,s.Lk)("div",$,[(0,s.Lk)("img",{src:e.data.imageUrl,onError:t[1]||(t[1]=e=>e.target.src="/placeholder.png")},null,40,z)]),(0,s.Lk)("h1",J,(0,c.v_)(e.data.name),1),(0,s.Lk)("p",M,"상품코드: "+(0,c.v_)(e.data.productCode),1)]),(0,s.Lk)("div",G,[(0,s.Lk)("div",Y,[(0,s.Lk)("button",{class:(0,c.C4)(["tab-btn",{active:"info"===p.value}]),onClick:t[2]||(t[2]=e=>p.value="info")},[...t[4]||(t[4]=[(0,s.Lk)("span",null,"상품 정보",-1)])],2),(0,s.Lk)("button",{class:(0,c.C4)(["tab-btn",{active:"similar"===p.value}]),onClick:t[3]||(t[3]=e=>p.value="similar")},[...t[5]||(t[5]=[(0,s.Lk)("span",null,"유사 상품 찾기",-1)])],2)]),(0,s.Lk)("div",q,["info"===p.value?((0,s.uX)(),(0,s.CE)("div",Z,[e.data.specifications?((0,s.uX)(),(0,s.CE)("div",ee,[t[6]||(t[6]=(0,s.Lk)("h3",null,"상세 스펙",-1)),(0,s.Lk)("div",ae,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(k.value,(e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"spec-item"},[(0,s.Lk)("span",te,(0,c.v_)(a),1),(0,s.Lk)("span",le,(0,c.v_)(e),1)]))),128))])])):(0,s.Q3)("",!0),e.data.priceHistory&&e.data.priceHistory.length>0?((0,s.uX)(),(0,s.CE)("div",se,[...t[7]||(t[7]=[(0,s.Lk)("h3",null,"가격 변동 그래프",-1),(0,s.Lk)("div",{class:"canvas-holder"},[(0,s.Lk)("canvas",{id:"priceChart"})],-1)])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0),"similar"===p.value?((0,s.uX)(),(0,s.CE)("div",ne,[(0,s.Lk)("div",ie,[t[10]||(t[10]=(0,s.Lk)("h3",null,"스펙 필터링 검색",-1)),t[11]||(t[11]=(0,s.Lk)("p",{class:"helper-text"},"찾으시는 상품의 조건을 선택하고 검색 버튼을 눌러주세요.",-1)),Object.keys(b.value).length>0?((0,s.uX)(),(0,s.Wv)(P,{key:0,specs:b.value,onFilterChange:f},null,8,["specs"])):(0,s.Q3)("",!0),r.value.length>0?((0,s.uX)(),(0,s.CE)("div",ce,[t[8]||(t[8]=(0,s.eW)(" 현재 조건에 맞는 상품: ",-1)),(0,s.Lk)("strong",null,(0,c.v_)(o.value.length),1),t[9]||(t[9]=(0,s.eW)("개 ",-1))])):(0,s.Q3)("",!0),(0,s.Lk)("button",{class:"search-btn",onClick:h,disabled:d.value||0===o.value.length},(0,c.v_)(d.value?"유사도 분석 중...":"이 조건으로 유사 상품 검색하기"),9,re)]),u.value.length>0?((0,s.uX)(),(0,s.CE)("div",oe,[(0,s.Lk)("h3",ue,"분석 결과 (상위 "+(0,c.v_)(u.value.length)+"개)",1),(0,s.Lk)("div",de,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(u.value,e=>((0,s.uX)(),(0,s.CE)("div",{class:"result-item",key:e.productCode,onClick:a=>g(e.productCode)},[(0,s.Lk)("div",pe,[(0,s.Lk)("img",{src:e.imageUrl,class:"result-img"},null,8,ke),(0,s.Lk)("div",ge,(0,c.v_)((100*e.similarity).toFixed(1))+"%",1)]),(0,s.Lk)("div",fe,[(0,s.Lk)("div",he,(0,c.v_)(e.productName),1)])],8,ve))),128))])])):(0,s.Q3)("",!0)])):(0,s.Q3)("",!0)])])])):(0,s.Q3)("",!0)]))}};const be=(0,j.A)(ye,[["__scopeId","data-v-5d78de30"]]);var me=be;const Ce={class:"app"};var Le={__name:"App",setup(e){const a=(0,n.KR)("list"),t=(0,n.KR)(null),l=(0,n.KR)("데스크탑"),c=async(e,l)=>{const s=l?"/api/new/product":"/api/product",n=await i.A.get(`http://localhost:8083${s}/${e}`);t.value=n.data,a.value="detail"};return(e,n)=>((0,s.uX)(),(0,s.CE)("div",Ce,["list"===a.value?((0,s.uX)(),(0,s.Wv)(S,{key:0,initialCategory:l.value,onViewDetail:c,onUpdateCategory:n[0]||(n[0]=e=>l.value=e)},null,8,["initialCategory"])):"detail"===a.value&&t.value?((0,s.uX)(),(0,s.Wv)(me,{key:1,data:t.value,onGoBack:n[1]||(n[1]=e=>a.value="list")},null,8,["data"])):(0,s.Q3)("",!0)]))}};const we=Le;var _e=we;(0,l.Ef)(_e).mount("#app")}},a={};function t(l){var s=a[l];if(void 0!==s)return s.exports;var n=a[l]={exports:{}};return e[l].call(n.exports,n,n.exports,t),n.exports}t.m=e,function(){var e=[];t.O=function(a,l,s,n){if(!l){var i=1/0;for(u=0;u<e.length;u++){l=e[u][0],s=e[u][1],n=e[u][2];for(var c=!0,r=0;r<l.length;r++)(!1&n||i>=n)&&Object.keys(t.O).every(function(e){return t.O[e](l[r])})?l.splice(r--,1):(c=!1,n<i&&(i=n));if(c){e.splice(u--,1);var o=s();void 0!==o&&(a=o)}}return a}n=n||0;for(var u=e.length;u>0&&e[u-1][2]>n;u--)e[u]=e[u-1];e[u]=[l,s,n]}}(),function(){t.d=function(e,a){for(var l in a)t.o(a,l)&&!t.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:a[l]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,a){return Object.prototype.hasOwnProperty.call(e,a)}}(),function(){t.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};t.O.j=function(a){return 0===e[a]};var a=function(a,l){var s,n,i=l[0],c=l[1],r=l[2],o=0;if(i.some(function(a){return 0!==e[a]})){for(s in c)t.o(c,s)&&(t.m[s]=c[s]);if(r)var u=r(t)}for(a&&a(l);o<i.length;o++)n=i[o],t.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return t.O(u)},l=self["webpackChunkvue_test"]=self["webpackChunkvue_test"]||[];l.forEach(a.bind(null,0)),l.push=a.bind(null,l.push.bind(l))}();var l=t.O(void 0,[504],function(){return t(4930)});l=t.O(l)})();
//# sourceMappingURL=app.ee4dd65b.js.map